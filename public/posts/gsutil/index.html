<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Download National Water Model (NWM) Data from Google Cloud Using Gsutil</title>
        
        <style>

    html body {
        font-family: 'Vollkorn', sans-serif;
        background-color: white;
    }

    :root {
        --accent: #4F97A3;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://yfhuang7.github.io/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Vollkorn">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.117.0">
        

        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Download National Water Model (NWM) Data from Google Cloud Using Gsutil</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="https://yufenhuang.notion.site/YU-FEN-HUANG-9152a5c75bc8467289ae6896a45b317f?pvs=4">About</a></li>
                            
                                <li><a href="/posts/">Posts</a></li>
                            
                                <li><a href="/publications/">Publications</a></li>
                            
                                <li><a href="/projects/">Projects</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:yfhuang@hawaii.edu"><i class="fa fa-envelope-o"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/yfhuang7/"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/WaterYFHuang/"><i class="fa fa-x-twitter"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.linkedin.com/in/yu-fen-%ef%bc%88%e9%83%81%e8%8a%ac%ef%bc%89-huang-%ef%bc%88%e9%bb%83%ef%bc%89-b3571267/"><i class="fa fa-linkedin"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.youtube.com/channel/UCtcPhvfrkjNhRcSFRBuIkvg"><i class="fa fa-youtube"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2>Download National Water Model (NWM) Data from Google Cloud Using Gsutil</h2>
        <h5></h5>
        
<a href="https://yfhuang7.github.io/tags/google-cloud"><kbd class="item-tag">Google Cloud</kbd></a>

<a href="https://yfhuang7.github.io/tags/nwm"><kbd class="item-tag">NWM</kbd></a>


    </div>

    <div align="start" class="content"><p><a href="https://water.noaa.gov/about/nwm">The National Water Model (NWM)</a> is a hydrologic modelling framework that simulates observed streamflow and complements official National Weather Service (NWS) river forecasts across the U.S., particularly produces guidance at locations that has no traditional river forecast. In the past, it is very difficult to access any NOAA archives. However, thanks to the <a href="https://www.noaa.gov/information-technology/open-data-dissemination">NOAA Open Data Dissemination (NODD) program</a>, a great number of NOAA data are now online cooperating with Amazon Web Services, Google, and Microsoft Azure. I found archived NWM outputs on <a href="https://console.cloud.google.com/storage/browser/national-water-model?pageState=(%22StorageObjectListTable%22:(%22f%22:%22%255B%255D%22))&amp;prefix=&amp;forceOnObjectsSortingFiltering=false">Google Cloud</a>. It&rsquo;s super to have the archive, but the next question came in: <strong>How am I going to bulk download? I don&rsquo;t want to click folders by folders and download files by files.</strong></p>
<p> </p>
<p>Fortunately, Google provides the <a href="https://cloud.google.com/sdk/docs/install-sdk">Google Cloud Command Line Interface (gcloud CLI)</a>, and the way to use it is very similar to how we use the shell. You just need to install the latest gcloud CLI with the selected system following their <a href="https://cloud.google.com/sdk/docs/install-sdk#windows">guide</a>. Then, you can start using it!</p>
<p> </p>
<p>First, you&rsquo;ll want to know the gsutil URI of the data you&rsquo;re going to download (here, NWM) by checking the configuration:</p>
<p><img src="/attachments/gsutil.JPG" alt="gsutil.jpg"></p>
<p>Then, you can go to your terminal or jupyter notebook/lab to view the contains (with the URI) of the folder by typing in the terminal:</p>
<pre tabindex="0"><code>gsutil -m ls &#34;&lt;gsutil URI&gt;&#34;
</code></pre><p>or in jupyter notebook/lab:</p>
<pre tabindex="0"><code>!gsutil -m ls &#34;&lt;gsutil URI&gt;&#34;
</code></pre><p>Of course, you can view it one the Google Cloud web console, but it will be much faster and clear by using gsutil when there are tons of data in the folder.</p>
<p> </p>
<p>After you figure out what data you want to download, you can download it by the concept of <code>cp</code>: simply copy the data from Google Cloud to your computer. The way to use it through gsutil is: <code>gsutil -m cp &quot;&lt;URI of the file&gt;&quot; .</code>. Besides download a single file, you can also download a folder by using <code>gsutil -m cp -r &quot;&lt;URI of the folder&gt;&quot; .</code>. Even better, you can also apply the wildcard using gsutil, ex: <code>gsutil -m ls &quot;gs://national-water-model/nwm.202104*/&quot; .</code> - in my case, it will list all the subfolders and files under each NWM folder in April, 2021.</p>
<p> </p>
<p>Is&rsquo;t it cool? Give it a try!</p>
</div>

</main>

        <footer>
            <p class="copyright text-muted">© All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>.</p>
        </footer>

        

        
    </body>

</html>

